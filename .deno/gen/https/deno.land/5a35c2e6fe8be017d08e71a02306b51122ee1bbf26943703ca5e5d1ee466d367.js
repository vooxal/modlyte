import { existsSync, parseYaml, path } from "../deps.ts";
const CONFIG_FILE_NAMES = ["scripts", "velociraptor"];
const CONFIG_FILE_EXTENSIONS = ["yaml", "yml", "json", "ts"];
export async function loadConfig() {
  let ext, name, dir = Deno.cwd();
  while (parent(dir) !== dir) {
    for (ext of CONFIG_FILE_EXTENSIONS) {
      for (name of CONFIG_FILE_NAMES) {
        const p = `${path.join(dir, name)}.${ext}`;
        if (existsSync(p)) {
          return {
            cwd: dir,
            config: await parseConfig(p, ext == "ts"),
          };
        }
      }
    }
    dir = parent(dir);
  }
  return null;
}
function parent(dir) {
  return path.join(dir, "..");
}
async function parseConfig(configPath, isTypescript) {
  if (isTypescript) {
    return (await import(`file://${configPath}`))
      .default;
  }
  return parseYaml(Deno.readTextFileSync(configPath));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9hZF9jb25maWcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJsb2FkX2NvbmZpZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFHekQsTUFBTSxpQkFBaUIsR0FBRyxDQUFDLFNBQVMsRUFBRSxjQUFjLENBQUMsQ0FBQztBQUN0RCxNQUFNLHNCQUFzQixHQUFHLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFPN0QsTUFBTSxDQUFDLEtBQUssVUFBVSxVQUFVO0lBQzlCLElBQUksR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBQ2hDLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEdBQUcsRUFBRTtRQUMxQixLQUFLLEdBQUcsSUFBSSxzQkFBc0IsRUFBRTtZQUNsQyxLQUFLLElBQUksSUFBSSxpQkFBaUIsRUFBRTtnQkFDOUIsTUFBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztnQkFDM0MsSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUU7b0JBQ2pCLE9BQU87d0JBQ0wsR0FBRyxFQUFFLEdBQUc7d0JBQ1IsTUFBTSxFQUFFLE1BQU0sV0FBVyxDQUFDLENBQUMsRUFBRSxHQUFHLElBQUksSUFBSSxDQUFDO3FCQUMxQyxDQUFDO2lCQUNIO2FBQ0Y7U0FDRjtRQUNELEdBQUcsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7S0FDbkI7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFFRCxTQUFTLE1BQU0sQ0FBQyxHQUFXO0lBQ3pCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDOUIsQ0FBQztBQUVELEtBQUssVUFBVSxXQUFXLENBQ3hCLFVBQWtCLEVBQ2xCLFlBQXFCO0lBRXJCLElBQUksWUFBWSxFQUFFO1FBQ2hCLE9BQU8sQ0FBQyxNQUFNLE1BQU0sQ0FBQyxVQUFVLFVBQVUsRUFBRSxDQUFDLENBQUM7YUFDMUMsT0FBK0IsQ0FBQztLQUNwQztJQUNELE9BQU8sU0FBUyxDQUNkLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsQ0FDVixDQUFDO0FBQzVCLENBQUMifQ==
